---
import type { Thing, WithContext } from 'schema-dts';

export interface Props {
  item: Thing | Thing[] | WithContext<Thing> | WithContext<Thing>[] | any;
  id?: string;
}

const { item, id } = Astro.props;


if (!item) {
}


const schemaData = Array.isArray(item) ? item : [item];


const processedSchemaData = schemaData
  .filter(schema => schema !== null && schema !== undefined)
  .map(schema => {
    if (typeof schema !== 'object') {
      return null;
    }
    
    
    return Object.assign({ '@context': 'https://schema.org' }, schema);
  })
  .filter(schema => schema !== null);


const finalSchema = processedSchemaData.length === 1 
  ? processedSchemaData[0] 
  : processedSchemaData;


let jsonLdOutput = '';
let shouldRender = false;

if (finalSchema && (Array.isArray(finalSchema) ? finalSchema.length > 0 : true)) {
  try {
    jsonLdOutput = JSON.stringify(finalSchema, null, 0);
    shouldRender = true;
  } catch (error) {
  }
}
---

{shouldRender && jsonLdOutput && (
  <script 
    type="application/ld+json" 
    id={id}
    set:html={jsonLdOutput}
  />
)}
